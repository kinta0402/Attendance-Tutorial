class SessionsController < ApplicationController

  def new
  end

  def create
    user = User.find_by(email: params[:session][:email].downcase)
      # ãƒã‚¹ãƒˆæ§‹é€ ã®ãƒãƒƒã‚·ãƒ¥ã®å€¤ã‚’å–å¾—ã—ã¦ã„ã‚‹ã€å…¥åŠ›ã•ã‚ŒãŸemailã‚’å–å¾—ã€‘
      # ãƒãƒƒã‚·ãƒ¥ã®ä¸­ã«ãƒãƒƒã‚·ãƒ¥ãŒã‚ã‚‹â†“
      # { session: { email: "sample@email.com", password: "password" } }
    if user && user.authenticate(params[:session][:password]) # 6.2.2ã«è¨˜è¼‰ã•ã‚Œã¦ã‚‹
      # â“µãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸå ´åˆã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ä½•ã‚’å…¥åŠ›ã—ã¦ã‚‚åˆ¤å®šã¯false
      # â“¶æœ‰åŠ¹ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒå–å¾—ã§ããŸãŒã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯é–“é•ã£ã¦ã„ã‚‹å ´åˆã®åˆ¤å®šã¯false
      # â“·æœ‰åŠ¹ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒå–å¾—ã§ãã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚‚ä¸€è‡´ã—ãŸå ´åˆã®åˆ¤å®šã¯true
      
      log_in user # session_helper ã«ã¦å®šç¾© ã€sessionã«ä¿å­˜ã•ã‚ŒãŸuser_idã‚’å–å¾—ã€‘(6.3.1å‚ç…§)
        # userã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®idã‚’session(cookie) ã«ä¿å­˜
      redirect_to user
        # redirect_to user_url(@user) ðŸ‘†railsã§ã¯å·¦è¨˜ã®ã‚³ãƒ¼ãƒ‰ã®ã‚ˆã†ã«å®Ÿè¡Œã—ãŸã„ã“ã¨ã‚’åˆ¤æ–­ã—ã¦ãã‚Œã¾ã™
    else
      flash.now[:danger] = 'èªè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸ'
        # flashå¤‰æ•°ã®ã¿ã ã¨ã€ï¾˜ï¾€ï¾žï½²ï¾šï½¸ï¾„ã—ã¦ã„ãªã„ç‚ºã€ï¾Œï¾—ï½¯ï½¼ï½­ï¾’ï½¯ï½¾ï½°ï½¼ï¾žãŒãšã£ã¨è¡¨ç¤ºã•ã‚Œã¦ã—ã¾ã†ã€‚
        # â‡’ ãã‚Œã‚’é˜²ãç‚ºã€flash.now ã«ã—ã¦ã„ã‚‹ (6.2.3 å‚ç…§)
      render :new
    end
  end
end